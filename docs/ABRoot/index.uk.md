---
title: Незмінюваність (ABRoot) - Vanilla OS
description: Дізнайтеся, як використовувати ABRoot.
---

# Незмінюваність (`abroot`)

`abroot` - це утиліта, яка забезпечує повну незмінність та атомарність, виконуючи транзакції між 2 кореневими розділами (A⟺B), вона також дозволяє виконувати транзакції на вимогу за допомогою транзакційної оболонки.

## Як це працює

Файлова система Linux - це ієрархічна файлова структура, яка містить кореневий та інші каталоги. 
Корінь - це основний ієрархічний каталог, який містить усі інші розділи.
У незмінних файлових системах кореневий розділ доступний лише для читання, що перешкоджає встановленню необхідних пакунків, таких як драйвери на хості.

Команда `abroot` дозволяє встановлювати модулі ядра, драйвери та інші необхідні пакунки, не порушуючи незмінність файлової системи. 

Коли команда виконується у `abroot`, запускається транзакція у транзакційній оболонці у другому кореневому розділі. Якщо транзакція завершується успішно, зміни застосовуються за допомогою оверлея і синхронізуються з поточним коренем при перезавантаженні. Якщо транзакція завершиться невдало, жодних змін не буде застосовано (через властивість, відому як атомарність). `abroot` також дозволяє виконувати транзакції на вимогу за допомогою команди `abroot shell`.

У встановленій Vanilla OS створюються кореневий та завантажувальний розділи для обох станів (20 ГБ на кореневий розділ), оскільки це є вимогою для `abroot`.

## Стани

У `abroot` є два стани - поточний і майбутній. Коли ви вперше встановлюєте Vanilla OS, поточним станом є A. При перезавантаженні системи стан автоматично змінюється на B. Коли ви встановлюєте пакунок за допомогою `abroot`, його буде встановлено у майбутній кореневий розділ і синхронізовано з поточним кореневим розділом при перезавантаженні.

## Оновлення

За допомогою `abroot` запускається утиліта `vso`, яка дозволяє здійснювати розумні автоматичні оновлення і встановлювати оновлення у фоновому режимі у майбутньому кореневому розділі, заощаджуючи час, оскільки не потрібно оновлювати пакунки під час перезавантаження.

## Параметри ядра

Команда `abroot` дозволяє встановити власні параметри ядра, якщо цього вимагають драйвери або користувацькі налаштування. За замовчуванням `abroot` зчитує вміст файлу `/etc/default/abroot_kargs`, який **не** слід редагувати. Замість цього слід скопіювати файл до `/etc/abroot` з назвою *"kargs"* за допомогою наступної команди:

```
sudo cp /etc/default/abroot_kargs /etc/abroot/kargs
```

[Параметри ядра](https://www.kernel.org/doc/html/v4.14/admin-guide/kernel-parameters.html) мають бути відокремлені пробілами і між ними **не повинно** бути розривів рядків. Крім того, не слід видаляти параметри, що містяться у файлі, якщо ви не знаєте, що робите.

Коли ви закінчите редагування файлу параметрів, ви можете ініціювати транзакцію, щоб `abroot` оновив файл завантаження. Це можна зробити, оновивши систему за допомогою `udo vso trigger-update --now` або виконавши будь-яку команду з `abroot exec` (наприклад, `udo abroot exec echo`).

**Зауважте, що файл kargs недоступний для текстових редакторів, встановлених за допомогою `apx`. Замість цього слід використовувати редактор, встановлений на хост-системі, наприклад `nano`.

## Іменування

Ім'я ABRoot відноситься до двох взаємодіючих кореневих розділів A і B (A⟺B).

## Використання

- [Manpage](/docs/ABRoot/manpage.uk.md)
- [Перенесення до вашого дистрибутива](/docs/ABRoot/porting.uk,md)

### Автори
```text
Спільнота Vanilla OS
Переклад: Сапуцький Петро (@voxelin)
```